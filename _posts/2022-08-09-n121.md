---
layout: single
title: "[n121] Bayes 이론"
categories: review
tag: [코드스테이츠, python, 통계]
toc: true

---





# 개념정리

- **전체 확률의 법칙**
  - 사건에 의해 발생한 모든 잠재적 결과들이 나올 확률의 합은 1이다.



## 이항분포

- 결과가 binary한 사건의 모든 잠재적 경우의 수와 이에 대한 확률을 보여준다.

  - 데이터 분석에서 소비자의 행동 패턴을 모델링 하는데 많이 이용
  - ex) 상품을 구매 or 비구매 / 클릭을 눌러 전환 or 비전환

- 동전을 n번 던져 앞면이 k번 나올 확률

  - n번 동전을 던저 앞면이 k번 나오는 경우의 수: `n! / (k!(n-k)!)`
  - k번 앞면이 나오고 n-k번 뒷면이 나오는 확률: `p**k((1-p)**(n-k))`
  - 이항 분포의 Formula는 1.의 n번 동전을 던저 앞면이 k번 나오는 경우의 수 에 2.의 k번 앞면이 나오고 n-k번 뒷면이 나오는 확률을 곱한 형태

- ##### `n! / (k!(n-k)!)` * `p**k((1-p)**(n-k))`







## 조건부확률

- **P(A | B) = P(A∩B) / P(B)**
  - 사건 A가 발생할 확률이 사건 B의 확률에 영향을 받는 것
- 실생활 예시
  - 전염병진단키트
    - 실제로 감염되었고 검사에서도 양성이 나온 사람
    - 감염되었지만 검사에서는 음성이 나온 사람
    - 감염되지 않았지만 검사에서는 양성이 나온 사람
    - 감염되지 않았고 검사에서도 음성이 나온 사람








## Bayesian Theorem

- **Bayes Rule**
  - Baysian은 사전확률(prior probability)에 테스트를 통해 얻은 증거를 사후 확률 (Posterior probability)에 포함하는 것
  - Posterior probability = Prior Probability (테스트를 진행하기 전의 확률) x Evidence (테스트로부터의 증거)

- **P(A|B)= P(A)*P(B|A)/P(B)**
  - B가 주어진 상황에서 A확률은 A확률에 A가 주어진 상황의 B확률을 곱하고 B확률로 나눈 값

- **사후확률(Posterior Distribution) 분포(Distribution)**
  - 과거의 믿음을 나타내는 Prior Distribution에 데이터를 통해 얻은 증거를 감안하여 나타나는 분포
  - **사후확률(Posterior Distribution)** : 확률 변수에 대한 관측이나 증거에 대한 조건부 확률

### 사전확률이 주관적인 경우

- 어떻게 베이지안 이론이 (사후확률이) 신뢰성을 가질 수 있을까
  - 베이즈 통계학은 기존 통계학과 달리 모집단을 변하지 않는 대상으로 보는 것이 아닌 **모수를 확률 변수**처럼 취급하고 사전 정보로부터 **새롭게 출발점**을 삼아 **정보가 증가**됨에 따라 확률의 신뢰성이 높아진다.

#### 날씨 예측 예시

1. 내일 비가 올 확률을 30퍼라고 가정하고(주관적) 하늘에 구름이 낄 확률은 일 평균 50퍼이다.(사실정보) 또한 비가 올 확률이 100퍼면 구름이 낄 확률도 100퍼다.
   - P(A)= 비가 올 확률= 30%
   - P(B)= 구름이 낄 확률= 50%
   - P(B|A)= 비가 올 때 구름이 낄 확률= 100%
2. 아침에 일어나니 하늘에 구름이 끼어 있음 > 이 정보로 베이지안 갱신을 사용해 비가올 확률을 계산 (구름이 꼈는데 비가올 확률)
   - P(A|B)=P(A)*P(B|A)/P(B)= 비 올 확률 * 비가 올 때 구름이 낄 확률/구름이 낄 확률
     - 30%*100%/50%=60%
3. 비가 올 확률에 대한 믿음을 60퍼로 갱신 가능

#### 스포츠 베팅 예시

1. 시합에서 크게 이길 확률을 50퍼라고 가정하고(주관적) 시합 중 비가 올 가능성은 10퍼라고 알고 있으며 시합에서 이길 때 비가 올 확률이 11퍼인 것도 알고있다.
   - P(A)= 시합에서 이길 확률= 50%
   - P(B)= 시합 중 비가 올 확률= 10%
   - P(B|A)= 시합에서 이길 때 비가 올 확률= 11%
2. 비가 올 시 시합에서 이길 확률은
   -  P(A|B)=P(A)*P(B|A)/P(B)= 50%*11%/10%= 55%









# 일일회고

## Keep (유지할 것)

- 식사 후 잠깐 걷기
- 휴식가지고 오늘은 망해따 ^^ 하고 공부 그만하지 않고 30분만 하고 자자는 생각으로 책상에 앉아서 공부 시작하기



## Problem (문제점, 방해 요소)

-  구글링을 하다보니 영어로된 문서가 많아 토종 100프로 한국인인 나는 어려움을 자주 겪게 된다.
-  여행가는 것 때문에 옷 신경쓰느라 신경 다 뺏긴거 드디어 오늘 다 사서 문제점이 해결되었으나 칭구가 코로나 걸려서 여행취소되었다... 그래서 허탈한 마음에 공부안함 (엥?)
-  토의시간에 먼 소리지.. 하고 멍때리다가 오후세션 집중못한 거



## Try (시도할 것)

- 영어로된 공식문서 계속 꾸준히 읽기
  - 남이 알기쉽게 번역해준 거 읽기 전에!! 공식문서를 참고해서 읽어보자
- 예상치 못한 상황이 발생해도 흔들리지 않는 마인드 컨드롤...
- 이해하지 못하는 경우가 발생하니 최대한 빨리 퀴즈+과제 끝내고 디스커션 주제 열심히 공부하기
  - 멍때리지 않고 최대한 집중하기 (듣고 보면 새로운 사실들을 알게되는 경우가 많음)
