---
layout: single
title: "모델의 해석 : 특성"
categories: review
tag: [ML]
toc: true

---





# What

**특성중요도**란?

> 각 특성이 예측 성능에 **얼마나** 영향을 주는지 쉽게 파악할 수 있게 해줌

## MDI (Mean Decrease Impurity)

- 트리 기반 모델에서 각 step에서 특정 피쳐에 의해 노드를 분할해 노드의 불순도를 감소시킴
  - 따라서 불순도를 크게 감소시키는데 사용된 feature들이 중요함
- sklearn의 트리기반모델은 평균불순도감소(MDI) 값을 사용하는 특성 중요도 계산을 기본적으로 제공함
- 장점
  - 빠르고 간편하게 계산이 가능하다.
- 단점
  - 높은 cardinality 특성에 높은 값을 부여하는 문제가 발생
    - 매 노드를 분할 시 cardinality가 높은 특성이 분할 기준 특성이 될 가능성이 높기 때문
    - 즉, cardinality가 너무 높은 특성이 있을 땐 믿을 만한 결과를 내지 못함







## Drop-Column Importance

- 각 특성을 사용하지 않고(drop함) 모델을 학습한 후 평가 성능을 모든 특성을 사용한 모델의 평가 성능과 비교한다.
  - 특성을 제거했을 때 평가 성능이 크게 하락했다면 해당 특성이 매우 중요한 특성이다.
- 단점
  - 이론적으로 가장 좋아보이지만 매 특성을 drop한 후 다시 fit하기 때문에 매우 느리다







## Permutation Importance

- 모델을 재학습시키지 않고 기존 모델에서 각 특성에 노이즈를 주어 모델이 해당 특성을 의사결정에 사용하지 못하게 만들었을 때 성능이 얼마나 감소하는지 확인
  - 노이즈를 주는 간단한 방법이 그 특성값들을 샘플들 내에서 섞는 것
- 장점
  - 재학습이 필요 없음
  - 모든 모델에 범용적으로 적용 가능
  - MDI보다 high cardinality 특성에 덜 치우친 결과를 낸다.
- 단점
  - 강한 상관관계가 있는 특성들이 존재할 시 잘못된 값을 낼 수 있다.



------

# How

각 특성이 증가/감소할 때 모델의 예측값이 어떻게 변하는지와 같이 모델의 예측에 어떻게 영향을 주는지 알 수 있다.



## ICE (Individual Conditional Expectation) plot

- **특정 관측치**(데이터 포인트)에 대해 **특정 특성**의 값을 변화시킬 때 모델의 예측 양상이 어떻게 변하는지 파악할 수 있다.
- 특성 간에 상관관계가 강할 경우 이 관계를 파악하고 싶을 때 사용 가능





## PDP (Partial Dependence Plot)

- 모델의 해당 특성에 대한 전반적인 이해 방식을 살펴볼 수 있음
  - 하나의 ICE plot만으로는 모델이 해당특성에 대해 전반적으로 어떻게 분석하고 이해하고 있는지 판단할 수 없음
  - PDP는 입력 데이터들에 대한 ICE plot을 평균하여 구할 수 있다.
- PDP 해석 시 유의할 점
  - PDP는 각 특성간의 독립성을 전제로 한다.
  - PDP 해석 시 살펴보고자 하는 특성값의 분포를 주의 깊게 살펴봐야 함
    - 존재하지 않는 데이터가 있는 경우 모델이 예측해서 집어 넣어 이상한 예측값을 낼 수 있다.
- 2개 특성의 변화에 대한 PDP를 heatmap 형태로 시각화 가능
- Global Methods
  - 각 특성 간 독립성을 가정하기에 특성 간 상관관계가 강할 경우 해석이 틀릴 수 있다.





# 정리

- Model-Specific
  - 사용하는 모델에 종속적인 방법
  - 손쉽게 사용 가능하지만 서로 다른 모델이 각기 특성을 어떻게 이해하고 있는지 비교해보기 어렵다.
    - 해석 가능한 정도의 모델은 복잡하지 않고 낮은 성능을 보인다. (제한적임)
- Model-Agnostic
  - 어느 모델에서나 적용할 수 있는 범용적인 해석법
  - 여러 형태의 모델들을 동일한 해석 방법을 사용해 해석하고 비교해볼 수 있음
    - 성능차이, 예측 양상의 차이 등을 이해하기 쉬움

|                | Global                                        | Local    |
| -------------- | --------------------------------------------- | -------- |
| Model-Specific | (DT) Feature Importance, (Linear) Coefficient | -        |
| Model-Agnostic | Drop-Column/Permutation Importance, PDP       | ICE plot |

